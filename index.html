<!DOCTYPE html>
<html lang="en">
  <head>
    <script defer data-domain="devnotes.tramline.app" src="https://plausible.io/js/script.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="https://devnotes.tramline.app/styles/styles.css">
    <link rel="stylesheet" href="https://devnotes.tramline.app/styles/header.css">
    <link rel="apple-touch-icon" sizes="180x180" href="https://devnotes.tramline.app/favicon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://devnotes.tramline.app/favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://devnotes.tramline.app/favicon.png">
    <title>Tramline | Engineering notes</title>
    <style type="text/css">
     body {
       text-rendering: optimizeLegibility;
       -webkit-font-smoothing: antialiased;
       -moz-osx-font-smoothing: grayscale;
     }
    </style>
  </head>

  <body class="bg-tram-green-light bg-no-repeat bg-gradient-to-br min-h-screen border-b-8 border-tram-green">
    
<header>
  <div data-collapse="small" data-animation="default" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="nav-bar w-nav">
    <div class="nav-container w-container">
      <div class="logo-div">
        <a href="https://tramline.app" aria-current="page" class="nav-logo w-inline-block w--current">
          <img src="https://devnotes.tramline.app/images/logo.png" loading="eager" width="50" alt="logo" class="logo">
        </a>
      </div>
      <nav role="navigation" class="nav-content w-nav-menu">
        <div class="nav-menu">
          <a href="/" aria-current="page" class="nav-link tramline w-nav-link w--current style-hNwNo" id="style-hNwNo">
            Tramline
            <p class="text-sm">engineering notes</p>
          </a>
        </div>
      </nav>
    </div>
  </div>
</header>

    <div class="border-b mb-3"></div>
    <main>
      <div class="px-2">
        <div class="mb-24 mt-16 px-4">
          <h1 data-w-id="18a9bc4c-33dd-e424-566d-cf277b93ef10" class="text-center heading-large style-J5dMq my-8" id="style-J5dMq">
            Short notes from engineering
          </h1>
          <div class="container max-w-[625px] mx-auto text-center
                      prose prose-lg
                      prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                      hover:prose-a:border-slate-200">
            <p>
              Micro-posts on programming and patterns as we build <a href="https://tramline.app" target="_blank">Tramline</a> in public.
              Follow this <a href="/atom.xml" target="_blank">feed</a> if you find these bits interesting.
            </p>
          </div>
        </div>
      </div>
      
<div class="feed">
	
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2023 &#x2F; Aug 08 — 19:41</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2023-08-08t19-41-37/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p><code>then</code> in <a href="https://apidock.com/ruby/v2_6_3/Object/then">Ruby</a> feels like a little sister to the <code>as-&gt;</code> <a href="https://clojuredocs.org/clojure.core/as-%3E">macro</a> from Clojure.</p>
<p>Most of the API code (and several other parts) in Tramline make heavy use of <code>then</code>.</p>
<p><a href="https://github.com/tramlinehq/tramline/blob/main/app/libs/installations/github/api.rb#L20">example</a>, <a href="https://github.com/tramlinehq/tramline/blob/main/app/libs/installations/gitlab/api.rb#L62">example</a>, <a href="https://github.com/tramlinehq/tramline/blob/main/app/libs/installations/google/firebase/api.rb#L49">example</a>.</p>
<p>There's a couple of interesting things of note here.</p>
<p>One, I think <a href="https://ruby-doc.org/core-2.7.0/Proc.html#class-Proc-label-Numbered+parameters">numbered params</a> have a lot of scope in removing some of the block cruft and overnaming of things across <code>then</code> blocks. Especially if the next in chain is visually obvious.</p>
<pre data-lang="ruby" style="background-color:#383838;color:#e6e1dc;" class="language-ruby "><code class="language-ruby" data-lang="ruby"><span style="color:#f6aa11;">@</span><span style="color:#d0d0ff;">client</span><span>.workflows(repo)
</span><span>       .then { fetch_workflows(_1) }
</span><span>       .then { pick_active(_1) }
</span><span>       .then { transform_keys(_1) }
</span></code></pre>
<p>The above feels more natural and less noisy than naming each intermediate step with similar sounding variable names.</p>
<p>The second one is a controversial (perhaps even wrong) point. It seems to me that since <code>then</code> is just a function, the general debuggability of something going wrong in the pipeline is easier to find out in the chain.</p>
<p>My (now fading) experience with threading macro debuggability in Clojure has been less efficient; I end up adding taps and spies and macroexpands to figure out what part of the chain broke.</p>
<p>I prefer an experience like:</p>
<ol>
<li>write a pipeline</li>
<li>pipeline breaks in expression number 2</li>
<li>error output nudges you in the direction of just tweaking expression number 2</li>
<li>make the fix and the pipeline starts working again</li>
</ol>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2023 &#x2F; Jan 18 — 13:41</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2023-01-18t13-41-44/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>All these years of using Rails, I had no idea <code>has_one</code> did this.</p>
<p><img src="/images/has_one.png" alt="" /></p>
<p>More importantly with a relationship like follows,</p>
<pre data-lang="ruby" style="background-color:#383838;color:#e6e1dc;" class="language-ruby "><code class="language-ruby" data-lang="ruby"><span style="color:#86c20e;">class </span><span style="text-decoration:underline;color:#ffc66d;">Model </span><span style="color:#86c20e;">&lt; </span><span style="text-decoration:underline;font-style:italic;color:#ffc66d;">ActiveRecord
</span><span>  has_one </span><span style="color:#f6f080;">:build
</span><span style="font-weight:bold;color:#86c20e;">end
</span><span>
</span><span style="color:#86c20e;">class </span><span style="text-decoration:underline;color:#ffc66d;">Build </span><span style="color:#86c20e;">&lt; </span><span style="text-decoration:underline;font-style:italic;color:#ffc66d;">ActiveRecord
</span><span>  has_one_attached_file </span><span style="color:#f6f080;">:file
</span><span style="font-weight:bold;color:#86c20e;">end
</span></code></pre>
<p>If I <code>create_build</code> on <code>Model</code> if one already exists, it will:</p>
<ol>
<li>Delete that <code>Build</code>, create a new one and attach it to <code>Model</code></li>
<li>Kickoff an <code>ActiveStorage::PurgeJob</code> and delete the file from GCS/AWS</li>
</ol>
<p>This is highly uncomfortable.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2023 &#x2F; Jan 10 — 14:58</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2023-01-10t14-58-17/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>I have been using <code>return</code> a fair bit in transactions in Rails. In 7, these rollback the transaction and I use them as so.</p>
<p>They obviously require very careful writing and to <strong>remember</strong> that the return actually just doesn't jump out of the block, it cancels the transaction.</p>
<p>I prefer the fact that <code>return</code> from 8 will throw an exception, but I've found that using <code>Github::Result</code> around transactions as a pattern comes pretty close or is better (in some cases) already.</p>
<p>Consider this example code that creates and merges a pull request,</p>
<pre data-lang="ruby" style="background-color:#383838;color:#e6e1dc;" class="language-ruby "><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold;color:#86c20e;">def </span><span style="color:#f6aa11;">create_and_merge!
</span><span>  </span><span style="color:#cc7833;">return </span><span style="font-style:italic;color:#6e9cbe;">Result</span><span>.</span><span style="color:#86c20e;">new</span><span>(</span><span style="color:#f6f080;">ok?: </span><span style="color:#ae81ff;">false</span><span>) </span><span style="font-weight:bold;color:#86c20e;">unless</span><span> create.ok?
</span><span>  upserted_pull_request </span><span style="color:#cc7833;">=
</span><span>    </span><span style="color:#f6aa11;">@</span><span style="color:#d0d0ff;">new_pull_request</span><span>.update_or_insert!(create.value)
</span><span>
</span><span>  transaction </span><span style="color:#cc7833;">do
</span><span>    upserted_pull_request.close! </span><span style="color:#95815e;"># close the PR
</span><span>
</span><span>    </span><span style="font-weight:bold;color:#86c20e;">if</span><span> merge.ok?
</span><span>      </span><span style="font-style:italic;color:#6e9cbe;">Result</span><span>.</span><span style="color:#86c20e;">new</span><span>(</span><span style="color:#f6f080;">ok?: </span><span style="color:#ae81ff;">true</span><span>)
</span><span>    </span><span style="font-weight:bold;color:#86c20e;">else
</span><span>      </span><span style="color:#cc7833;">return </span><span style="font-style:italic;color:#6e9cbe;">Result</span><span>.</span><span style="color:#86c20e;">new</span><span>(</span><span style="color:#f6f080;">ok?: </span><span style="color:#ae81ff;">false</span><span>, </span><span style="color:#f6f080;">error: </span><span style="color:#f92672;">&quot;</span><span style="color:#c1be91;">Failed!</span><span style="color:#f92672;">&quot;</span><span>)
</span><span>    </span><span style="font-weight:bold;color:#86c20e;">end
</span><span>  </span><span style="font-weight:bold;color:#86c20e;">end
</span><span style="font-weight:bold;color:#86c20e;">end
</span><span>
</span><span style="font-weight:bold;color:#86c20e;">def </span><span style="color:#f6aa11;">create
</span><span>  </span><span style="color:#95815e;"># creates a PR and returns a Result
</span><span style="font-weight:bold;color:#86c20e;">end
</span><span>
</span><span style="font-weight:bold;color:#86c20e;">def </span><span style="color:#f6aa11;">merge
</span><span>  </span><span style="color:#95815e;"># merges a PR and returns a Result
</span><span style="font-weight:bold;color:#86c20e;">end
</span><span>
</span><span>Result </span><span style="color:#cc7833;">= </span><span style="font-style:italic;color:#6e9cbe;">Struct</span><span>.</span><span style="color:#86c20e;">new</span><span>(</span><span style="color:#f6f080;">:ok?</span><span>, </span><span style="color:#f6f080;">:error</span><span>, </span><span style="color:#f6f080;">:value</span><span>, </span><span style="color:#f6f080;">keyword_init: </span><span style="color:#ae81ff;">true</span><span>)
</span></code></pre>
<p>One problem here is that we're using custom <code>Result</code> objects which are not very chainable. But the other more shape-y problem is that we're having to check the output from <code>merge</code>, return an ok-<code>Result</code> or else <strong>cancel</strong> the transaction and <strong>then</strong> return a not-ok-<code>Result</code>. This not only feels like excessive work but also the use of <code>return</code> is unfortunate to essentially carry out a rollback + value type scenario.</p>
<p>With <code>Github::Result</code> we can rewrite it much more cleanly,</p>
<pre data-lang="ruby" style="background-color:#383838;color:#e6e1dc;" class="language-ruby "><code class="language-ruby" data-lang="ruby"><span style="font-weight:bold;color:#86c20e;">def </span><span style="color:#f6aa11;">create_and_merge!
</span><span>   </span><span style="color:#cc7833;">return </span><span style="font-style:italic;color:#6e9cbe;">GitHub</span><span>::</span><span style="font-style:italic;color:#6e9cbe;">Result</span><span>.</span><span style="color:#86c20e;">new </span><span>{ </span><span style="color:#86c20e;">raise </span><span style="color:#6e9cbe;">CreateError </span><span>} </span><span style="font-weight:bold;color:#86c20e;">unless</span><span> create.ok?
</span><span>   upserted_pull_request </span><span style="color:#cc7833;">=
</span><span>     </span><span style="color:#f6aa11;">@</span><span style="color:#d0d0ff;">new_pull_request</span><span>.update_or_insert!(create.value!)
</span><span>
</span><span>   </span><span style="font-style:italic;color:#6e9cbe;">GitHub</span><span>::</span><span style="font-style:italic;color:#6e9cbe;">Result</span><span>.</span><span style="color:#86c20e;">new </span><span style="color:#cc7833;">do
</span><span>     transaction </span><span style="color:#cc7833;">do
</span><span>       upserted_pull_request.close! </span><span style="color:#95815e;"># close the PR
</span><span>       merge.value!
</span><span>     </span><span style="font-weight:bold;color:#86c20e;">end
</span><span>  </span><span style="font-weight:bold;color:#86c20e;">end
</span><span style="font-weight:bold;color:#86c20e;">end
</span></code></pre>
<p>As long as <code>merge</code> throws an exception, <code>value!</code> will raise it, rollback (throwing an exception will rollback) and opaquely pass it further up to the wrappper <code>Result</code>. This allows us to avoid <code>return</code> magic and ugly raises in the middle of the transaction block and chain the exceptions up.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2023 &#x2F; Jan 06 — 14:36</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2023-01-06t14-36-17/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p><img src="/images/txns-suck.png" alt="" /></p>
<p>This is terrible.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2023 &#x2F; Jan 06 — 14:25</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2023-01-06t14-25-59/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>I decided to add stricter linting to the codebase. Since I like what standard offers, I simply extended it with rails specific lints, in the following way:</p>
<pre data-lang="yaml" style="background-color:#383838;color:#e6e1dc;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#e8bf6a;">require</span><span>:
</span><span>  - </span><span style="color:#a5c261;">standard
</span><span>  - </span><span style="color:#a5c261;">rubocop-rails
</span><span>  - </span><span style="color:#a5c261;">rubocop-rspec
</span><span>  - </span><span style="color:#a5c261;">rubocop-performance
</span><span>
</span><span style="color:#e8bf6a;">inherit_gem</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">standard</span><span>: </span><span style="color:#a5c261;">config/ruby-3.0.yml
</span><span>
</span><span style="color:#e8bf6a;">AllCops</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">TargetRubyVersion</span><span>: </span><span style="color:#a5c261;">3.1
</span><span>  </span><span style="color:#e8bf6a;">NewCops</span><span>: </span><span style="color:#a5c261;">enable
</span><span>  </span><span style="color:#e8bf6a;">Exclude</span><span>:
</span><span>    - </span><span style="color:#a5c261;">bin/**/*
</span><span>    - </span><span style="color:#a5c261;">public/**/*
</span><span>    - </span><span style="color:#a5c261;">vendor/**/*
</span><span>    - </span><span style="color:#a5c261;">db/schema.rb
</span><span>
</span><span style="color:#e8bf6a;">Rails</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">Enabled</span><span>: </span><span style="color:#6e9cbe;">true
</span><span>
</span><span style="color:#e8bf6a;">RSpec</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">Enabled</span><span>: </span><span style="color:#6e9cbe;">true
</span><span>
</span><span style="color:#e8bf6a;">RSpec/ExampleLength</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">Enabled</span><span>: </span><span style="color:#6e9cbe;">false
</span><span>
</span><span style="color:#e8bf6a;">RSpec/MultipleExpectations</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">Max</span><span>: </span><span style="color:#a5c261;">4
</span><span>
</span><span style="color:#e8bf6a;">Performance</span><span>:
</span><span>  </span><span style="color:#e8bf6a;">Enabled</span><span>: </span><span style="color:#6e9cbe;">true
</span></code></pre>
<p>This ensures standard is used for ruby things, and rails, rspec and some other performance related checks in addition to it via rubocop.</p>
<p>I came across this suggestion while fixing the 100 odd offenses it threw up,</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>RSpec/NamedSubject:
</span><span>  Name your test subject if you need to reference it explicitly.
</span></code></pre>
<p>The fix,</p>
<pre data-lang="ruby" style="background-color:#383838;color:#e6e1dc;" class="language-ruby "><code class="language-ruby" data-lang="ruby"><span>subject(</span><span style="color:#f6f080;">:run</span><span>) { create(</span><span style="color:#f6f080;">:releases_train_run</span><span>) }
</span></code></pre>
<p>But what even is this? Isn't this just a <code>let</code> really? You can't really use the <code>is_expected.to</code> shortcut either since it's now named. I cannot possibly make the claim that this reads better.</p>
<p>I think it's just one of those annoying rspec maximalisms.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Oct 11 — 15:44</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-10-11t15-44-45/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>Here's a spectrum of componentizing views I've been thinking about lately (in Rails):</p>
<ol>
<li>Extract logical helpers and partials</li>
</ol>
<p>They are often like stuffing away code inside a <code>Module</code> and calling it a refactor. But it is cheap and effective enough to start off with. You often run into &quot;too many allocations&quot; issues, with nested views and partials. They also don't abstract state very well. Arguments for their limitations have been made ad naseam - <a href="https://github.com/drapergem/draper">ex</a>.</p>
<pre data-lang="text" style="background-color:#383838;color:#e6e1dc;" class="language-text "><code class="language-text" data-lang="text"><span>Completed 200 OK in 86ms (Views: 83.6ms | ActiveRecord: 1.3ms | Allocations: 29347)
</span></code></pre>
<ol start="2">
<li>Presenter objects / ViewComponents</li>
</ol>
<p>Solid ideas here. Fair bit of upfront work required and you have to be meticulous about the granularity of your components. These claim to be very fast by precompiling templates at rails boot.</p>
<ol start="3">
<li>SPAs, building JSX components (or whatever else is out there now)</li>
</ol>
<p>I'm not convinced I'd need to do this. I think Stimulus / Hotwired is powerful enough for all our needs for the forseeable future (famous last words). I still remember the joy of ripping out all the react from a <a href="https://github.com/simpledotorg/simple-server">previous codebase</a> I worked on and rewrote them in a much simpler, basic markup and js.</p>
<p>#1 ➡ #2 hopefuly in a few months time.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Oct 06 — 12:23</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-10-06t12-23-54/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>When I originally kicked things off, I added a lot of big transactions around various api-call-surrounding-database-ops. This was knowingly a cheap hack to avoid bad state changes and delaying the inevitable: careful and tedious handling of errors and control-flow.</p>
<p>I'm now slowly refactoring things to unpack these big transactions and I realize many of them are actually unnecessary. I'm employing yet another cheap <code>Result</code> object to signify boundary-states,</p>
<pre data-lang="ruby" style="background-color:#383838;color:#e6e1dc;" class="language-ruby "><code class="language-ruby" data-lang="ruby"><span>Result </span><span style="color:#cc7833;">= </span><span style="font-style:italic;color:#6e9cbe;">Struct</span><span>.</span><span style="color:#86c20e;">new</span><span>(</span><span style="color:#f6f080;">:ok?</span><span>, </span><span style="color:#f6f080;">:error</span><span>, </span><span style="color:#f6f080;">:value</span><span>, </span><span style="color:#f6f080;">keyword_init: </span><span style="color:#ae81ff;">true</span><span>)
</span><span>
</span><span style="font-weight:bold;color:#86c20e;">def </span><span style="color:#f6aa11;">good_op
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">Result</span><span>.</span><span style="color:#86c20e;">new</span><span>(</span><span style="color:#f6f080;">ok?: </span><span style="color:#ae81ff;">true</span><span>, </span><span style="color:#f6f080;">value: </span><span style="color:#a5c261;">1</span><span>)
</span><span style="font-weight:bold;color:#86c20e;">end
</span><span>
</span><span style="font-weight:bold;color:#86c20e;">def </span><span style="color:#f6aa11;">bad_op
</span><span>  </span><span style="font-style:italic;color:#6e9cbe;">Result</span><span>.</span><span style="color:#86c20e;">new</span><span>(</span><span style="color:#f6f080;">ok?: </span><span style="color:#ae81ff;">false</span><span>, </span><span style="color:#f6f080;">error: </span><span style="color:#f92672;">&quot;</span><span style="color:#c1be91;">Did not work</span><span style="color:#f92672;">&quot;</span><span>)
</span><span style="font-weight:bold;color:#86c20e;">end
</span><span>
</span><span>operation.ok?
</span><span>operation.value
</span><span>operation.error
</span></code></pre>
<p>This is a little bit silly, because it requires <em>you</em> to ensure that <code>value</code> is only present alongside the <code>ok?</code> and the others are falsey in the <code>error</code> case. But it is very simple and quick to get a refactor busted out.</p>
<p>I have used <a href="https://github.com/github/github-ds#githubresult">Github::Result</a> in the past, but recently discovered <a href="https://dry-rb.org/gems/dry-monads/1.3">dry-rb</a> -- many of these look very sensible and immediately useful. Hopefully the next step!</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Oct 05 — 00:19</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-10-05t00-19-39/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p><img src="/images/rubymine.png" alt="" /></p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Sep 28 — 11:15</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-09-28t11-15-40/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>There are a few tight, but rare-enough race-conditions lingering about and they are constantly bothering me. They just exist as <code>FIXMEs</code> in the code atm.</p>
<p>Most of the these seem to be solvable by pessimistic row-locks, but I'm already dreading the littering of necessary but unintuitive placements of various row-locks throughout the code-base.</p>
<p>Would modelling this as a pure declarative orchestrator help keep this in check?</p>
<p>Not sure.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Sep 28 — 11:15</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-09-28t11-15-39/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>The views currently are a hot mess, giant nested ERB templates.
I'm not convinced of jumping into <a href="https://viewcomponent.org">ViewComponents</a> yet, since the shape of this UI is so nebulous and will definitely change dramatically and I do not want to deal with more objects and more abstractions and more code at the moment.</p>
<p>I'll deal with the complex markup like it's 1999.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Sep 28 — 09:02</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-09-28t09-02-54/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>It's not terribly hard to come up with a state-machine DSL like <a href="https://github.com/aasm/aasm">aasm</a>
by hand, but the <code>ActiveRecord</code> support is very handy.</p>
<p>I'm using it with an <code>enum</code> against a <code>status</code> field with the following options:</p>
<pre data-lang="ruby" style="background-color:#383838;color:#e6e1dc;" class="language-ruby "><code class="language-ruby" data-lang="ruby"><span>{
</span><span>  </span><span style="color:#f6f080;">column: :status</span><span>,
</span><span>  </span><span style="color:#f6f080;">requires_lock: </span><span style="color:#ae81ff;">true</span><span>,
</span><span>  </span><span style="color:#f6f080;">requires_new_transaction: </span><span style="color:#ae81ff;">false</span><span>,
</span><span>  </span><span style="color:#f6f080;">enum: </span><span style="color:#ae81ff;">true</span><span>,
</span><span>  </span><span style="color:#f6f080;">create_scopes: </span><span style="color:#ae81ff;">false
</span><span>}
</span></code></pre>
<p>The <code>requires_new_transaction</code> is <code>false</code> to avoid landing into unnecessary nested transactions. I'll keep my transactions explicit and intentional.
The <code>enum</code> allows me to play well with the Rails enum which already generates scopes, so I keep <code>create_scopes</code> off.</p>
<p>The <code>requires_lock</code> is seemingly quite handy at first glance, since I require locking rows a fair bit because of the distributed nature of the app.
But the level at which it locks is far too granular. I generally seem to require locking rows for far longer and more work than simply transitioning state and not everything can be sanely encapsulated in a <code>before</code> or <code>after</code>.
I'd rather provide the library with methods that cause a state transition than the inverted way it currently operates: generating methods to transition for you and then locking within that event.</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Sep 26 — 11:37</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-09-26t11-37-01/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>I'm finding keeping POROs seperated away from <code>models/</code> a mental relief for some reason. I think I'm going to stick to it.</p>
<p><img src="/images/dir.png" alt="" /></p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
  
<article class="container max-w-[900px] mx-auto my-8 px-2">
  <hr class="border-slate-200 mx-auto max-w-7xl">
  <div class="my-8"></div>
  <div class="md:flex">
    <div class="md:basis-[100px] md:flex-grow-0 md:flex-shrink-0 md:mr-4 px-1 ml-3 mb-8">
      <div class="font-medium my-2 leading-normal text-xs">
        <div class="tracking-wide">2022 &#x2F; Sep 25 — 21:18</div>
        <div class="mt-2 mb-2 underline">kitallis</div>
        <a href="https://devnotes.tramline.app/post-2022-09-25t21-18-31/">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24">
            <g fill="none" class="nc-icon-wrapper">
              <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" fill="#212121">
              </path>
            </g>
          </svg>
        </a>
      </div>
    </div>
    <div class="container max-w-[900px] mx-auto px-4">
      <div class="md:flex-grow md:ml-4">
        <div class="max-w-none
                    prose prose-md
                    prose-a:border-b-[1px] prose-a:border-slate-500 prose-a:font-sans prose-a:no-underline
                    hover:prose-a:border-b-slate-200
                    prose-pre:prose-code:prose-a:text-sm prose-code:prose-p:text-sm
                    prose-h1:font-bold prose-h1:text-base
                    prose-p:font-serif
                    prose-p:prose-blockquote:font-sans
                    prose-strong:font-sans
                    prose-ol:font-serif
                    prose-ul:font-serif">
		      <p>The log streams feature in <a href="https://render.com">Render</a> is a little bit strange. From the <a href="https://render.com/docs/log-streams#configuring-log-streams">docs</a>,</p>
<pre style="background-color:#383838;color:#e6e1dc;"><code><span>Render Log Streams forward logs from your web services,
</span><span>private services, background workers, databases,
</span><span>and cron jobs to any logging provider that supplies a TLS-enabled syslog drain.
</span></code></pre>
<p>I hooked this up with datadog and it is indeed a syslog drain across <em>all</em> services. This means my newly setup datadog is now filled with thousands of non-application related logs. Not only now do I have to filter all these out, but also pay for them.</p>
<p>Surely a log streaming pipeline should have a minimum of a service-level (if not content-level) filtering as baseline features?</p>

        </div>
      </div>
	  </div>
  </div>
</article>

  
</div>

<nav class="pageControls">
	

	
</nav>

    </main>
  </body>
</html>
